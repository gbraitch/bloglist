(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{53:function(e,t,n){e.exports=n(81)},80:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),l=n.n(c),o=n(40),u=n(6),i=n.n(u),s=n(11),m=n(8),d=n(39),f=n(38),b=n(20),p=function(e){var t=e.num,n=e.blog,a=e.addLike,c=e.removeBlog,l=e.user;return r.a.createElement(f.a,{className:"mb-1"},r.a.createElement(d.a,null,r.a.createElement(d.a.Header,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-11"},r.a.createElement(f.a.Toggle,{as:b.a,variant:"link",eventKey:t},n.title," by ",n.author)),r.a.createElement("div",{className:"col-md-1 float-right"},n.user.username===l.username?r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-danger btn-sm py-0 mt-3",onClick:c},"remove")):r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-danger btn-sm py-0 mt-3","data-toggle":"tooltip","data-placement":"right",title:"User did not create this note","aria-disabled":"true",disabled:!0},"remove"))))),r.a.createElement(f.a.Collapse,{eventKey:t},r.a.createElement(d.a.Body,null,r.a.createElement("div",null,r.a.createElement("strong",null,"Title: ")," ",n.title),r.a.createElement("div",null,r.a.createElement("strong",null,"Author: ")," ",n.author),r.a.createElement("div",null," ",r.a.createElement("strong",null,"URL: ")," ",n.url),r.a.createElement("div",null,r.a.createElement("strong",null,"Likes: "),n.likes," ",r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-sm py-0 btn-primary",onClick:a},"Like!"))))))},v=n(52),g=function(e){var t=e.notification;return t?r.a.createElement(v.a,{variant:"".concat("success"===t.type?"success":"danger"," alert ml-3")},t.message):null},E=n(28),h=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(m.a)(n,2),l=c[0],o=c[1],u={display:l?"none":""},i={display:l?"":"none"},s=function(){o(!l)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),r.a.createElement("div",null,r.a.createElement("div",{style:u},r.a.createElement("button",{className:"btn btn-outline-primary",onClick:s},e.buttonLabel)),r.a.createElement("div",{style:i},r.a.createElement(E.a,{in:l},r.a.createElement("div",null,e.children,r.a.createElement(b.a,{className:"btn btn-danger ml-3",onClick:s},"cancel")))))}));h.displayName="Togglable";var k=h,y=function(e){var t=e.handleNewBlog,n=e.notifyWith,c=Object(a.useState)(""),l=Object(m.a)(c,2),o=l[0],u=l[1],d=Object(a.useState)(""),f=Object(m.a)(d,2),b=f[0],p=f[1],v=Object(a.useState)(""),g=Object(m.a)(v,2),E=g[0],h=g[1],k=function(){var e=Object(s.a)(i.a.mark((function e(a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault();try{t({title:o,author:b,url:E}),u(""),p(""),h("")}catch(r){n("Failed to add new blog","error"),console.log("Failed to create blog")}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"mx-3"},r.a.createElement("h3",null,"Add New Blog"),r.a.createElement("form",{onSubmit:k},r.a.createElement("div",null,"Title:",r.a.createElement("input",{className:"form-control",type:"text",value:o,name:"Title",onChange:function(e){var t=e.target;return u(t.value)}})),r.a.createElement("div",null,"Author:",r.a.createElement("input",{className:"form-control",type:"text",value:b,name:"Author",onChange:function(e){var t=e.target;return p(t.value)}})),r.a.createElement("div",null,"URL:",r.a.createElement("input",{className:"form-control",type:"text",value:E,name:"URL",onChange:function(e){var t=e.target;return h(t.value)}})),r.a.createElement("button",{className:"btn btn-primary",type:"submit"},"add")))},N=n(23),w=n(50),O=n(17),j=n.n(O),x=function(e){return localStorage.setItem("loggedBlogAppUser",JSON.stringify(e))},S=function(){return JSON.parse(localStorage.getItem("loggedBlogAppUser"))},C=function(){return localStorage.removeItem("loggedBlogAppUser")},A="/api/blogs",B=function(){return{headers:{Authorization:"bearer ".concat(S().token)}}},I={getAll:function(){return j.a.get(A).then((function(e){return e.data}))},create:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post(A,t,B());case 2:return n=e.sent,e.next=5,j.a.get("".concat(A,"/").concat(n.data.id));case 5:return a=e.sent,e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e){return j.a.put("".concat(A,"/").concat(e.id),e,B()).then((function(e){return e.data}))},remove:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.delete("".concat(A,"/").concat(t),B());case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L={login:function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},U=function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(null),u=Object(m.a)(l,2),d=u[0],f=u[1],b=Object(a.useState)(""),v=Object(m.a)(b,2),E=v[0],h=v[1],O=Object(a.useState)(""),j=Object(m.a)(O,2),A=j[0],B=j[1],U=Object(a.useState)(null),T=Object(m.a)(U,2),R=T[0],W=T[1],J=Object(a.useState)("Sort By"),F=Object(m.a)(J,2),P=F[0],q=F[1],D=Object(a.useState)(null),H=Object(m.a)(D,2),K=H[0],V=H[1],z=r.a.createRef();Object(a.useEffect)((function(){I.getAll().then((function(e){return c(e)}))}),[]),Object(a.useEffect)((function(){var e=S();f(e);var t=document.querySelector('.theme-switch input[type="checkbox"]'),n=localStorage.getItem("theme");n&&(document.documentElement.setAttribute("data-theme",n),"dark"===n&&(t.checked=!0))}),[]);var G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";W({message:e,type:t}),setTimeout((function(){W(null)}),5e3)},M=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,L.login({username:E,password:A});case 4:n=e.sent,h(""),B(""),f(n),G("Welcome Back ".concat(n.name,"!")),x(n),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),G("Incorrect username or password","error"),console.log("Wrong credentials");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(s.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.create(t);case 3:a=e.sent,z.current.toggleVisibility(),c(n.concat(a)),G("A new blog: ".concat(a.title," has been added")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(s.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(o.a)({},t,{likes:t.likes+1,user:t.user.id}),e.next=3,I.update(a);case 3:c(n.map((function(e){return e.id===t.id?Object(o.a)({},t,{likes:t.likes+1}):e})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Remove blog ".concat(t.title," by ").concat(t.author))){e.next=5;break}return e.next=4,I.remove(t.id);case 4:c(n.filter((function(e){return e.id!==t.id})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(e){q(e),V(e)},$=function(){return r.a.createElement("div",{className:"theme-switch-wrapper float-right"},r.a.createElement("label",{className:"theme-switch"},r.a.createElement("input",{type:"checkbox",id:"checkbox",onClick:function(e){return _(e)}}),r.a.createElement("div",{className:"slider round"})),r.a.createElement("em",null))},_=function(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))};return d?r.a.createElement("div",{className:"container"},r.a.createElement(g,{notification:R}),$(),r.a.createElement("div",null,r.a.createElement("div",{className:"mt-5"},r.a.createElement("h1",{className:"text-center"},"blogs"),r.a.createElement("button",{className:"btn btn-outline-danger float-right",onClick:function(){return f(null),void C()}},"logout")),r.a.createElement("h2",null," Welcome ",d.name," "),r.a.createElement("div",{className:"mt-5"},r.a.createElement(k,{buttonLabel:"Add New Blog",ref:z},r.a.createElement(y,{handleNewBlog:Q,notifyWith:G}))),r.a.createElement("div",{className:"mt-5"},r.a.createElement("div",null,r.a.createElement("h2",null,"bloglist",r.a.createElement(w.a,{title:P,className:"format float-right"},r.a.createElement(N.a.Item,{as:"button"},r.a.createElement("div",{onClick:function(e){return Z(e.target.textContent)}},"Likes")),r.a.createElement(N.a.Item,{as:"button"},r.a.createElement("div",{onClick:function(e){return Z(e.target.textContent)}},"Title")),r.a.createElement(N.a.Item,{as:"button"},r.a.createElement("div",{onClick:function(e){return Z(e.target.textContent)}},"Author"))))),r.a.createElement("div",{className:"mt-4"},function(){var e;if("Likes"===K)e=function(e,t){return function(e,t){return t.likes-e.likes}(e,t)};else if("Title"===K)e=function(e,t){return function(e,t){return e.author.localeCompare(t.author)}(e,t)};else{if("Author"!==K)return n.map((function(e,t){return r.a.createElement(p,{num:t+1,key:e.id,blog:e,addLike:function(){return X(e)},removeBlog:function(){return Y(e)},user:d})}));e=function(e,t){return function(e,t){return e.title.localeCompare(t.title)}(e,t)}}return n.sort(e).map((function(e,t){return r.a.createElement(p,{num:t+1,key:e.id,blog:e,addLike:function(){return X(e)},removeBlog:function(){return Y(e)},user:d})}))}())))):r.a.createElement("div",{className:"container"},r.a.createElement(g,{notification:R}),$(),r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",{className:"mt-5 mb-3"},"Please sign in"),r.a.createElement("form",{style:{maxWidth:"480px",margin:"auto"},onSubmit:M},r.a.createElement("input",{type:"text",className:"form-control mb-2",placeholder:"Username",value:E,name:"Username",required:!0,autoFocus:!0,onChange:function(e){var t=e.target;return h(t.value)}}),r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Password",value:A,name:"Password",onChange:function(e){var t=e.target;return B(t.value)}}),r.a.createElement("div",{className:"mt-3"},r.a.createElement("button",{className:"btn btn-lg btn-block btn-primary",type:"submit"},"Sign In")))))};n(79),n(80);l.a.render(r.a.createElement(U,null),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.fa6dc453.chunk.js.map